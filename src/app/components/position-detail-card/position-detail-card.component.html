<div *ngIf="position as pos; else loading" class="position-info-container">
    <div class="position-blocks">
        <span (click)="addToBasket($event)" class="can-basket">
            <ng-container *ngIf="!isAdded; else remove">Add to</ng-container>
            <ng-template #remove>Remove from</ng-template>
            store <md-icon>library_add</md-icon>
        </span>
        <div class="position-block">
            <div class="position-info-item position-status" *ngIf="pos.status">{{pos.status}}</div>
            <div class="position-feedback">
                <div class="large-container">
                    <div class="small-container">
                        <div class="position-info-item position-project-name">
                            <span class="attribute">Project</span>
                            <span>{{pos.projectName}}</span>
                        </div>
                        <div class="position-info-item position-vacancy-name">
                            <span class="attribute">Vacancy</span>
                            <span>{{pos.vacancyName}}</span>
                        </div>
                        <div class="position-info-item position-date">
                            <span class="attribute">Request date</span>
                            <span>{{pos.requestDate | date : 'mediumDate'}}</span>
                        </div>
                        <div class="position-info-item position-date">
                            <span class="attribute">Start date</span>
                            <span>{{pos.startDate | date : 'mediumDate'}}</span>
                        </div>
                        <div class="position-info-item position-date">
                            <span class="attribute">Close date</span>
                            <span>{{pos.closeDate | date : 'mediumDate'}}</span>
                        </div>
                        <div class="position-info-item position-link">
                            <span class="attribute">Link on project</span>
                            <span>{{pos.link}}</span>
                        </div>
                        <div class="position-info-item position-skill-container">
                            <span class="attribute attribute-skills">Primary skill</span>
                            <md-chip-list class="position-skills">
                                <md-chip>
                                    <div class="position-skill-name">{{pos.primarySkill?.name}}</div>
                                    <!-- : level - {{pos.primarySkill?.level}} -->
                                </md-chip>
                            </md-chip-list>
                        </div>
                        <div class="position-info-item position-skill-container">
                            <span class="attribute attribute-skills">Secondary skills</span>
                            <div class="position-skills">
                                <ng-container *ngFor="let item of pos.secondarySkills">
                                    <img class="position-skill-img" *ngIf="item.picture as pic; else text" [src]="pic">
                                    <ng-template #text>
                                        <md-chip-list>
                                            <md-chip>
                                                <div class="position-skill-name">{{item.name}}</div>
                                            </md-chip>
                                        </md-chip-list>
                                    </ng-template>
                                </ng-container>
                            </div>
                        </div>
                        <div class="position-info-item position-english-level">
                            <span class="attribute">English(min)</span>
                            <span>{{pos.engLevel}}</span>
                        </div>
                        <div class="position-info-item position-english-level">
                            <span class="attribute">Experience(years)</span>
                            <span>{{pos.experience}}</span>
                        </div>
                        <div class="position-info-item position-english-level">
                            <span class="attribute">City </span>
                            <span>{{pos.city}}</span>
                        </div>
                        <div class="position-info-item position-english-level">
                            <span class="attribute">HR manager</span>
                            <span>{{pos.hrm?.name}}</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <button (click)="goToEditForm()">Edit</button>
        <div class="position-info-item candidates">
            <span class="attribute">Current candidates</span>
            <div class="candidates-list">
                <candidate-preview-mini *ngFor="let can of pos.candidates" [candidate]="can"></candidate-preview-mini>
            </div>
        </div>

        <button (click)="this.isSearchShown = !this.isSearchShown">
            <ng-container *ngIf="!isSearchShown; else hide">Show auto-search</ng-container>
            <ng-template #hide>Hide auto-search</ng-template>
        </button>
        <div [hidden]="!isSearchShown">
            <div>
                Primary skill
                <range-form [(range)]="coefficient" [min]="0" [max]="100"></range-form>
                Secondary skills
            </div>
            <button (click)="autoSearch()">autosearch</button>
            <div *ngFor="let can of possibleCandidates">
                <button (click)="assignCandidate(can.id)"><md-icon>add</md-icon></button>
                <candidate-preview-mini [candidate]="can"></candidate-preview-mini>
            </div>
            <button *ngIf="possibleCandidates.length" [hidden]="hasNoCan" (click)="nextPage()">show more</button>
        </div>
    </div>
</div>
<ng-template #loading>
    <spinner [loading]="true"></spinner>
</ng-template>
